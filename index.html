<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mervemin Ruh Hali â¤ï¸</title>
  <style>
    :root{
      --bg1:#0b0b0d;
      --bg2:#121217;
      --card:#15151a;
      --btn:#1f1f26;
      --stroke:rgba(255,255,255,.10);
      --soft:rgba(0,0,0,.35);
    }
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      margin:0; color:#fff;
      background: radial-gradient(1200px 700px at 20% 0%, #1a1630 0%, transparent 55%),
                  radial-gradient(1000px 600px at 90% 15%, #10243a 0%, transparent 55%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    .wrap{max-width:720px; margin:0 auto; padding:18px;}
    h1{font-size:32px; margin:12px 0 18px; letter-spacing:.2px; line-height:1.15;}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    button{
      border:1px solid var(--stroke);
      border-radius:22px;
      padding:20px 14px;
      font-size:18px;
      font-weight:900;
      background: linear-gradient(180deg, #222231, var(--btn));
      color:#fff;
      box-shadow: 0 14px 30px var(--soft);
      transition: transform .06s ease, filter .2s ease;
      cursor:pointer;
    }
    button:hover{filter:brightness(1.05);}
    button:active{transform:scale(0.98);}
    .full{grid-column:1 / -1;}

    .card{
      margin-top:16px;
      background: linear-gradient(180deg, #191922, var(--card));
      border:1px solid var(--stroke);
      border-radius:24px;
      padding:18px;
      box-shadow: 0 18px 40px var(--soft);
    }
    .label{font-size:14px; opacity:.70; margin-bottom:10px;}
    #status{
      font-size:34px; line-height:1.25; font-weight:900;
      white-space:pre-line; letter-spacing:.1px;
    }
    .sub{margin-top:12px; font-size:14px; opacity:.65; white-space:pre-line;}
    .warn{margin-top:10px; font-size:14px; opacity:.55; line-height:1.35;}

    .secretWrap{margin-top:14px; display:flex; justify-content:center;}
    .secretBtn{
      width:min(520px, 100%);
      padding:18px 14px;
      font-size:18px;
      border-radius:22px;
      background: linear-gradient(180deg, #232336, #1f1f26);
      border:1px solid rgba(255,255,255,.12);
    }

    .modal{
      display:none;
      position:fixed; inset:0;
      background:rgba(0,0,0,.72);
      backdrop-filter: blur(8px);
      z-index:9999;
      padding:18px;
    }
    .modalInner{
      max-width:720px; margin:0 auto; height:100%;
      display:flex; align-items:center; justify-content:center;
    }
    .modalCard{
      width:100%;
      background: linear-gradient(180deg, #191922, #14141b);
      border:1px solid rgba(255,255,255,.12);
      border-radius:24px;
      padding:18px;
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      position:relative;
    }
    .modalClose{
      position:absolute; top:12px; right:12px;
      width:44px; height:44px;
      border-radius:14px; padding:0;
      font-size:18px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
    }
    .modalText{
      font-size:34px; line-height:1.25; font-weight:900;
      white-space:pre-line; letter-spacing:.1px;
      margin:0; padding-right:56px;
    }

    .choiceArea{
      margin-top:16px;
      height:25vh; min-height:160px; max-height:240px;
      display:flex; gap:12px; align-items:stretch;
    }
    .choiceArea button{
      height:100%;
      border-radius:22px;
      font-size:20px;
      padding:16px 12px;
    }
    .yesBtn{
      background: linear-gradient(180deg, #2b5d3a, #1f1f26);
      border:1px solid rgba(255,255,255,.18);
      flex:1;
    }
    .noBtn{
      background: linear-gradient(180deg, #5d2b2b, #1f1f26);
      border:1px solid rgba(255,255,255,.18);
      flex:1;
    }

    .meetGrid{
      margin-top:16px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Mervemin Ruh Hali â¤ï¸</h1>

    <div class="grid">
      <button onclick="mood('ÃœzgÃ¼nÃ¼m')">ğŸ˜” ÃœzgÃ¼nÃ¼m</button>
      <button onclick="mood('Mutluyum')">ğŸ˜„ Mutluyum</button>

      <button onclick="openMeet()">ğŸ“ BuluÅŸalÄ±m</button>
      <button onclick="mood('Ã–zledim')">ğŸ¥º Ã–zledim</button>

      <button class="full" onclick="mood('KÄ±zgÄ±nÄ±m')">ğŸ˜¡ KÄ±zgÄ±nÄ±m</button>

      <button class="full" onclick="money()">ğŸ’¸ Param Bitti</button>
      <button class="full" onclick="danger()">ğŸš¨ Tehlikedeyim</button>
    </div>

    <div class="card">
      <div class="label">Son mesaj</div>
      <div id="status">Bir butona bas ğŸ‘‡</div>
      <div id="sub" class="sub"></div>

      <div class="warn">
        Meraktan hepsine basÄ±p mesajlarÄ± tÃ¼ketme ğŸ™‚ Ä°htiyaÃ§ oldukÃ§a kullan.
      </div>

      <div class="secretWrap">
        <button class="secretBtn" onclick="openSecret()">ğŸ™ˆ Gizli Soru</button>
      </div>
    </div>
  </div>

  <!-- Gizli Soru Modal -->
  <div id="secretModal" class="modal" onclick="modalBgClose(event)">
    <div class="modalInner">
      <div class="modalCard" onclick="event.stopPropagation()">
        <button class="modalClose" onclick="closeSecret()">âœ•</button>
        <p id="secretText" class="modalText"></p>
        <div class="choiceArea">
          <button id="secretYes" class="yesBtn" onclick="secretYes()">Evet</button>
          <button id="secretNo" class="noBtn" onclick="secretNo()">HayÄ±r</button>
        </div>
      </div>
    </div>
  </div>

  <!-- BuluÅŸalÄ±m Modal -->
  <div id="meetModal" class="modal" onclick="meetBgClose(event)">
    <div class="modalInner">
      <div class="modalCard" onclick="event.stopPropagation()">
        <button class="modalClose" onclick="closeMeet()">âœ•</button>
        <p id="meetText" class="modalText">Ne yapalÄ±m?</p>
        <div class="meetGrid">
          <button onclick="meetPick('Kahve')">â˜• Kahve</button>
          <button onclick="meetPick('Yemek')">ğŸ½ï¸ Yemek</button>
          <button onclick="meetPick('Sinema')">ğŸ¬ Sinema</button>
          <button onclick="meetPick('DiÄŸer')">âœ¨ DiÄŸer</button>
        </div>
      </div>
    </div>
  </div>

<script>
  // ====== NTFY ======
  const TOPIC = "Yanimdaappdemo"; // kendi topic'in neyse burayÄ± yaz
  const NTFY = "https://ntfy.sh/" + TOPIC;

  // Demo iÃ§in gerÃ§ek olmayan numara
  const MY_PHONE = "05000000000";

  const MONEY_TEXT = "Kocambank devrede";

  // ====== SIRALI MESAJ SEÃ‡Ä°CÄ° (eÅŸindeki gibi) ======
  function nextSequential(key, arr){
    if (!arr || arr.length === 0) return "(mesaj yok)";
    const k = "seq_" + key;
    let i = parseInt(localStorage.getItem(k) || "0", 10);
    if (isNaN(i) || i < 0) i = 0;
    const msg = arr[i % arr.length];
    localStorage.setItem(k, String((i + 1) % arr.length));
    return msg;
  }

  // Ã–rnek 2â€™ÅŸer mesaj (istersen artÄ±r)
  const MSG = {
    "ÃœzgÃ¼nÃ¼m": [
      "CanÄ±mâ€¦ tamam. Åu an tek isteÄŸim iyi olman. Ä°stersen konuÅŸalÄ±m, ben buradayÄ±m.",
      "ÃœzgÃ¼n olduÄŸunu gÃ¶rmek iÃ§imi sÄ±kÄ±yor. Bir ÅŸey yapabiliyorsam sÃ¶yle, birlikte toparlarÄ±z."
    ],
    "Mutluyum": [
      "Ay bunu duyunca ben de gÃ¼lÃ¼msedim ğŸ˜„ Anlat bakalÄ±m, ne gÃ¼zel oldu seni bÃ¶yle gÃ¶rmek!",
      "Harika! MutluluÄŸun bana da bulaÅŸtÄ±. MÃ¼saitsen birazdan sesini duyayÄ±m mÄ±?"
    ],
    "Ã–zledim": [
      "Ben de seni Ã§ok Ã¶zledimâ€¦ Ä°lk fÄ±rsatta kavuÅŸalÄ±m. BugÃ¼n/yarÄ±n bir plan yapalÄ±m mÄ±?",
      "Ã–zlemin geldi mi dÃ¼nyada baÅŸka bir ÅŸeyin Ã¶nemi kalmÄ±yor. Birazdan arayayÄ±m mÄ±?"
    ],
    "KÄ±zgÄ±nÄ±m": [
      "Tamam, seni anlÄ±yorum. Åu an tartÄ±ÅŸmak istememâ€”sakinleÅŸince konuÅŸalÄ±m ve Ã§Ã¶zelim.",
      "KÄ±zgÄ±n olman boÅŸuna deÄŸil. Kalbini kÄ±rdÄ±ysam Ã¶zÃ¼r dilerim. Ne hissediyorsan dinlemek istiyorum."
    ]
  };

  const MEET = {
    "Kahve": [
      "Kahve gÃ¼zel fikir â˜• Neredesin, konum at; geliyorum.",
      "Tamam kahve! Oturup sakin sakin konuÅŸalÄ±m. Saat kaÃ§ uygun?"
    ],
    "Yemek": [
      "Yemek olsun ğŸ½ï¸ Senin canÄ±n ne Ã§ekiyor? Ben ayarlÄ±yorum.",
      "Tamam! Sen seÃ§ ya da ben seÃ§eyimâ€”yeter ki buluÅŸalÄ±m."
    ],
    "Sinema": [
      "Sinema Ã§ok iyi ğŸ¬ Film seÃ§, bilet benden.",
      "Tamam! SeansÄ± sÃ¶yle; sonra biraz yÃ¼rÃ¼yÃ¼ÅŸ de yaparÄ±z."
    ],
    "DiÄŸer": [
      "Sen ne istersenâ€¦ Benim tek ÅŸartÄ±m: yanÄ±nda olmak.",
      "Tamam, sÃ¼rprize de varÄ±m. PlanÄ± yaz, ben hazÄ±rÄ±m."
    ]
  };

  // Gizli soru (sÄ±rayla)
  const SECRET_ITEMS = [
    { id: "Gizli Soru 1", question: "Beni seviyor musun?", yesReply: "Biliyordum ğŸ˜„\nBen de seni Ã§ok seviyorum." },
    { id: "Gizli Soru 2", question: "Beni seÃ§er misin, yine yeniden?", yesReply: "Tam da bunu duymak istiyordum ğŸ˜„\nÄ°yi ki varsÄ±n." }
  ];

  function setStatus(bigText, smallText=""){
    document.getElementById("status").textContent = bigText;
    document.getElementById("sub").textContent = smallText;
  }

  function ntfySend(title, message, priority="high", tags=""){
    const url =
      `${NTFY}/publish?` +
      `title=${encodeURIComponent(title)}` +
      `&message=${encodeURIComponent(message)}` +
      `&priority=${encodeURIComponent(priority)}` +
      (tags ? `&tags=${encodeURIComponent(tags)}` : "") +
      `&t=${Date.now()}`;
    try { fetch(url, { method:"GET", mode:"no-cors", cache:"no-store", keepalive:true }); } catch(e){}
    const img = new Image();
    img.referrerPolicy = "no-referrer";
    img.src = url;
  }

  // Mood: SIRALI
  function mood(type){
    const arr = MSG[type] || ["(mesaj yok)"];
    const msg = nextSequential(`mood_${TOPIC}_${type}`, arr);
    setStatus(msg, `${type} â†’ gÃ¶nderildi âœ…`);
    ntfySend(type, msg, "high", "speech_balloon");
  }

  // Money
  function money(){
    setStatus(MONEY_TEXT, "Param Bitti â†’ gÃ¶nderildi âœ…");
    ntfySend("Param Bitti", MONEY_TEXT, "high", "moneybag");
  }

  // Danger
  function getLocation(){
    return new Promise((resolve, reject) => {
      if(!navigator.geolocation) return reject("Konum desteklenmiyor");
      navigator.geolocation.getCurrentPosition(
        (pos)=>resolve(pos.coords),
        (err)=>reject(err.message),
        { enableHighAccuracy:true, timeout:10000, maximumAge:0 }
      );
    });
  }

  async function danger(){
    setStatus("Konum alÄ±nÄ±yorâ€¦", "Ä°zin verirsen konum gÃ¶nderilecek");
    let maps = "Konum alÄ±namadÄ± (izin verilmedi olabilir)";
    try{
      const c = await getLocation();
      maps = `https://maps.google.com/?q=${c.latitude},${c.longitude}`;
    }catch(e){}

    const body = `Tehlikedeyim butonuna basÄ±ldÄ±!\nKonum: ${maps}\n(Demo arama: ${MY_PHONE})`;
    setStatus(body, "Tehlikedeyim â†’ gÃ¶nderildi âœ…");
    ntfySend("Tehlikedeyim", body, "urgent", "rotating_light,warning");

    window.location.href = `tel:${MY_PHONE}`;
  }

  // Meet modal
  function openMeet(){
    document.getElementById("meetModal").style.display = "block";
    ntfySend("BuluÅŸalÄ±m", "BuluÅŸalÄ±m menÃ¼sÃ¼ aÃ§Ä±ldÄ±.", "high", "round_pushpin");
  }
  function closeMeet(){ document.getElementById("meetModal").style.display = "none"; }
  function meetBgClose(e){ if (e.target && e.target.id === "meetModal") closeMeet(); }

  // Meet: SIRALI
  function meetPick(kind){
    const arr = MEET[kind] || ["BuluÅŸalÄ±m mÄ±?"];
    const msg = nextSequential(`meet_${TOPIC}_${kind}`, arr);
    closeMeet();
    setStatus(msg, `BuluÅŸalÄ±m â†’ ${kind} âœ…`);
    ntfySend("BuluÅŸalÄ±m", `${kind} seÃ§ildi:\n${msg}`, "high", "round_pushpin");
  }

  // Secret: sÄ±rayla sorular
  function nextSecretItem(){
    const k = "idx_secret_demo_" + TOPIC;
    const idx = parseInt(localStorage.getItem(k) || "0", 10);
    const item = SECRET_ITEMS[idx % SECRET_ITEMS.length];
    localStorage.setItem(k, String((idx + 1) % SECRET_ITEMS.length));
    return item;
  }

  let secretState = "ask";
  let noCount = 0;
  let currentSecretItem = null;

  function setYesNoWidths(noPercent){
    const yes = document.getElementById("secretYes");
    const no  = document.getElementById("secretNo");
    const yesPercent = 100 - noPercent;
    yes.style.flex = `0 0 ${yesPercent}%`;
    no.style.flex  = `0 0 ${noPercent}%`;
  }

  function openSecret(){
    secretState = "ask";
    noCount = 0;
    currentSecretItem = nextSecretItem();

    const txt = document.getElementById("secretText");
    const yes = document.getElementById("secretYes");
    const no  = document.getElementById("secretNo");

    txt.textContent = currentSecretItem.question;
    yes.textContent = "Evet";
    no.textContent  = "HayÄ±r";
    no.style.display = "inline-block";
    setYesNoWidths(50);

    document.getElementById("secretModal").style.display = "block";
    ntfySend("Gizli Soru", `${currentSecretItem.id}\nSoru: ${currentSecretItem.question}`, "high", "see_no_evil");
  }

  function closeSecret(){ document.getElementById("secretModal").style.display = "none"; }
  function modalBgClose(e){ if (e.target && e.target.id === "secretModal") closeSecret(); }

  function secretNo(){
    if (secretState !== "ask") return;
    noCount++;

    const txt = document.getElementById("secretText");

    if (noCount === 1){
      txt.textContent = "Hadi ama bir daha dÃ¼ÅŸÃ¼n.";
      setYesNoWidths(33.3333);
      ntfySend("Gizli Soru", `${currentSecretItem.id}\nHayÄ±r dedi (1/3) ğŸ™ˆ`, "high", "see_no_evil");
    } else if (noCount === 2){
      txt.textContent = "Olmaz bu cevabÄ± kabul etmiyorum.";
      setYesNoWidths(16.6667);
      ntfySend("Gizli Soru", `${currentSecretItem.id}\nHayÄ±r dedi (2/3) ğŸ™ˆ`, "high", "see_no_evil");
    } else {
      txt.textContent = "Bak son kez soruyorum.";
      document.getElementById("secretNo").style.display = "none";
      document.getElementById("secretYes").style.flex = "1";
      ntfySend("Gizli Soru", `${currentSecretItem.id}\nHayÄ±r yok oldu ğŸ˜„ (3/3)`, "high", "see_no_evil");
    }
  }

  function secretYes(){
    const txt = document.getElementById("secretText");
    const yes = document.getElementById("secretYes");
    const no  = document.getElementById("secretNo");

    if (secretState === "result"){
      closeSecret();
      return;
    }
    secretState = "result";
    txt.textContent = currentSecretItem.yesReply;
    no.style.display = "none";
    yes.textContent = "Tamam";
    yes.style.flex = "1";
    ntfySend("Gizli Soru", `${currentSecretItem.id}\nEVET dedi ğŸ˜„`, "high", "heart_eyes");
  }
</script>
</body>
</html>
